# Лабораторная работа №4

**Симулятор библиотеки (коллекции, индексирование, наследование)**

## Описание

Проект моделирует работу библиотеки, содержащей книги разных типов.
Система реализует **две пользовательские коллекции** (списковую и словарную),
индексирует данные, поддерживает поиск по ключевым полям и выполняет симуляцию
работы библиотеки в пошаговом режиме.

В проекте применены:

* композиция коллекций;
* наследование в предметной области (`Book`, `RareBook`, `DigitalBook`);
* магические методы (`__len__`, `__iter__`, `__getitem__`, `__repr__`);
* генерация случайных событий, влияющих на состояние библиотеки;


## Функциональность

### Предметная модель

| Класс         | Описание                                                 |
| ------------- | -------------------------------------------------------- |
| `LibraryItem` | базовый класс сущности библиотеки                        |
| `Book`        | стандартная книга                                        |
| `RareBook`    | редкое издание с ценностью и уровнем редкости            |
| `DigitalBook` | электронная книга (формат файла, условное число страниц) |

### Пользовательские коллекции

#### 1) Списковая (`BookCollection`)

* хранение объектов `Book` / `LibraryItem`
* поддержка: `__len__`, `__iter__`, `__getitem__`, добавление и удаление
* доступ к элементам по индексу и срезам

#### 2) Словарная (`BookIndex`)

* индексирование книг по:

  * `ISBN`
  * `Автору`
  * `Году`
* поддержка: `__len__`, `__iter__`, `__getitem__`
* автоматическая синхронизация при добавлении/удалении книги

###  Поиск

* `find_by_author(name)`
* `find_by_year(year)`
* `find_by_isbn(isbn)`

## Симуляция

Реализована функция:

```python
run_simulator(steps: int = 20, seed: int | None = None)
```

Функция выполняет `steps` шагов.
На каждом шаге случайно выбирается одно событие:

| Событие                    | Поведение                      |
| -------------------------- |--------------------------------|
| `event_add_book`           | добавление книги               |
| `event_remove_random_book` | удаление случайного экземпляра |
| `event_find_by_author`     | поиск по автору                |
| `event_find_by_year`       | поиск по году                  |
| `event_find_existing_isbn` | поиск существующей книги       |
| `event_find_fake_isbn`     | поиск по несуществующему ISBN  |
| `event_get_books_count`    | текущее количество книг        |

Запуск:

```
python -m src.main
```

## Тестирование

Проект использует `pytest`.

Покрываем:

* добавление/удаление книги;
* корректность поиска по автору, году и ISBN;
* работу индексной коллекции;
* целостность данных после удаления;

Запуск тестов:

```
python -m pytest
```


## Установка и запуск

1. Клонировать репозиторий

   ```
   git clone <url>
   ```
2. Создать окружение

   ```
   python -m venv .venv && source .venv/bin/activate
   ```
3. Установить зависимости

   ```
   pip install -r requirements.txt
   ```
4. Запустить симуляцию

   ```
   python -m src.main
   ```
